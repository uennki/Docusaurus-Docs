---
sidebar_position: 4
---

JavaScript 从诞生之日起就是一门**单线程**的**非阻塞**的脚本语言。

- 单线程： 为了满足与浏览器交互，避免引发操作问题。
- 非阻塞： 通过**事件循环机制**，解决单线程阻塞问题。

## 事件循环机制

### 什么是事件循环

事件循环，就是一种浏览器的 JS 引擎对 JavaScript 任务代码的运行分配机制。

它可以看作由两部分组成：

- 任务队列：一个先进先出的队列，里面存放着各种任务。
- 事件循环：指主线程重复从任务队列中获取任务、并执行的过程。

<img src="/img/js/event-loop.png" width="500" />

### 事件循环流程

上图就是事件循环机制的流程图示。简单概括：

1. 所有同步任务都在主线程上执行，形成一个执行栈
2. 所有异步任务的回调结果，都将有序放置在任务队列内
3. 等执行栈中的代码执行完毕，再去读取任务队列中的任务，加入执行栈中执行
4. 如此循环

## 异步与同步

在 JavaScript 中所有的任务都可以分为两种：

- 同步任务
- 异步任务

### 同步任务

同步任务，就是每次只做一个任务，如果有多个任务，则必须排队依次进行。

```js
console.log(100);
alert(200);
console.log(300);
```

同步任务的缺陷在于，一旦某个任务出错或超时，则会**阻塞后续任务的进行**。

### 异步任务

异步任务，有效解决了同步任务存在阻塞缺陷。它可以分为两类：

- 宏任务 macro task
  - setInterval
  - setTimeout
- 微任务 micro task
  - new Promise
  - new MutaionObserver

:::tip
_注意：在事件循环中，**微任务优先执行**，再执行宏任务。_
:::
